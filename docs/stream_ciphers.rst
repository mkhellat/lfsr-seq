Stream Cipher Analysis
======================

This section provides a comprehensive introduction to stream cipher analysis,
focusing on real-world stream ciphers that use LFSRs. The documentation is
designed to be accessible to beginners while providing sufficient depth for
researchers and developers. We begin with intuitive explanations and gradually
build to rigorous mathematical formulations.

Introduction
------------

**What is a Stream Cipher?**

A **stream cipher** is a symmetric encryption algorithm that encrypts data one
bit (or byte) at a time, typically by XORing the plaintext with a pseudorandom
keystream. Stream ciphers are widely used in applications requiring high-speed
encryption, such as wireless communications, disk encryption, and network protocols.

**Historical Context and Motivation**

Stream ciphers have been used for secure communications since the early days of
cryptography. The Vernam cipher (1917), also known as the one-time pad, is the
theoretically perfect stream cipher, but requires a key as long as the message.
Modern stream ciphers use pseudorandom keystream generators to approximate the
security of one-time pads while using much shorter keys.

LFSR-based stream ciphers emerged in the 1980s and 1990s, with designs like
A5/1 (GSM) and E0 (Bluetooth) becoming widely deployed. However, many early
designs were found to have vulnerabilities, leading to the development of more
sophisticated designs like Trivium and Grain, which were selected as eSTREAM
finalists (2004-2008).

**Key Characteristics**:

- **Symmetric**: Same key is used for encryption and decryption
- **Streaming**: Processes data incrementally (one bit/byte at a time)
- **Keystream**: Pseudorandom sequence generated from secret key
- **XOR Operation**: Plaintext is XORed with keystream to produce ciphertext

**Why Analyze Stream Ciphers?**

1. **Real-World Relevance**: Many deployed systems use stream ciphers (GSM, Bluetooth)
2. **Educational Value**: Understanding practical applications of LFSRs
3. **Security Analysis**: Assessing cipher security and vulnerabilities
4. **Research**: Comparing designs and identifying weaknesses
5. **Design Guidance**: Learning from historical mistakes to design better ciphers

**Stream Ciphers Covered**:

This documentation covers analysis of the following stream ciphers:

- **A5/1**: GSM mobile phone encryption (:math:`3` LFSRs, irregular clocking)
- **A5/2**: Weaker GSM variant (:math:`4` LFSRs)
- **E0**: Bluetooth encryption (:math:`4` LFSRs, non-linear combiner)
- **Trivium**: eSTREAM finalist (:math:`3` shift registers, non-linear feedback)
- **Grain Family**: Grain-128, Grain-128a (LFSR + NFSR)
- **LILI-128**: Academic design (:math:`2` LFSRs, clock control)

Key Concepts
------------

Stream Cipher Fundamentals
~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Keystream Generation**:

The keystream is generated from:
- **Secret Key**: A secret value known only to sender and receiver
- **Initialization Vector (IV)**: A non-secret value that varies per message
- **State**: Internal state of the cipher (LFSRs, memory, etc.)

The keystream generation process:
1. Initialize cipher state with key and IV
2. Run warm-up phase (optional, discards initial output)
3. Generate keystream bits by evolving state

**Encryption Process**:

.. math::

   C_i = P_i \oplus K_i

where:
- :math:`C_i` is ciphertext bit :math:`i`
- :math:`P_i` is plaintext bit :math:`i`
- :math:`K_i` is keystream bit :math:`i`
- :math:`\oplus` is XOR operation

**Decryption Process**:

Decryption is identical to encryption (XOR is its own inverse):

.. math::

   P_i = C_i \oplus K_i

**Key Terminology**:

- **Keystream**: Pseudorandom sequence of bits generated by the cipher
- **Key**: Secret value used to initialize the cipher (typically
  :math:`80`-:math:`256` bits)
- **Initialization Vector (IV)**: Non-secret value ensuring different
  keystreams for same key (also called "nonce" or "frame number")
- **State**: Internal state of the cipher (LFSR states, memory
  elements, etc.)
- **Warm-up Phase**: Initial steps where output is discarded (removes
  initialization artifacts)
- **Encryption**: Process of converting plaintext to ciphertext using
  keystream
- **Decryption**: Process of converting ciphertext back to plaintext
- **XOR (Exclusive OR)**: Binary operation where :math:`0 \oplus 0 =
  0`, :math:`0 \oplus 1 = 1`, :math:`1 \oplus 0 = 1`, :math:`1 \oplus
  1 = 0`

LFSR-Based Stream Ciphers
~~~~~~~~~~~~~~~~~~~~~~~~~~

Many stream ciphers use LFSRs as building blocks because:

- **Hardware Efficiency**: LFSRs are fast in hardware (simple shift and XOR
  operations)
- **Statistical Properties**: LFSRs have good statistical properties when using
  primitive polynomials (maximal period, good distribution)
- **Well-Understood Theory**: LFSR theory is well-understood, making analysis
  and design more tractable
- **Period Guarantees**: Primitive polynomials guarantee maximum period
  :math:`q^d - 1` for degree :math:`d` LFSR over :math:`\mathbb{F}_q`

**Common Design Patterns**:

1. **Multiple LFSRs**: Combine several LFSRs for increased complexity and larger
   state space
2. **Irregular Clocking**: LFSRs don't always advance (clock control introduces
   non-linearity)
3. **Non-Linear Combining**: Use non-linear functions instead of simple XOR to
   prevent linear analysis
4. **Filter Functions**: Apply non-linear functions to LFSR state to create
   non-linear output
5. **Non-Linear Feedback**: Use non-linear feedback instead of linear
   (generalizes LFSR to NFSR)

**Why LFSRs Alone Are Not Sufficient**:

A single LFSR with linear combining is vulnerable to:
- **Berlekamp-Massey Algorithm**: Can recover LFSR from :math:`2d` keystream bits
- **Linear Complexity**: Linear complexity is at most :math:`d` (the LFSR degree)
- **Linear Analysis**: Linear relationships can be exploited

Therefore, stream ciphers add non-linearity through:
- Irregular clocking (A5/1, LILI-128)
- Non-linear combining (E0 with FSM, Trivium with AND operations)
- Filter functions (Grain)
- Non-linear feedback (Trivium, Grain NFSR)

**Key Terminology**:

- **LFSR-Based Cipher**: Stream cipher using LFSRs as core components
- **Multiple LFSRs**: Using several LFSRs in parallel for increased security and
  larger state space
- **Irregular Clocking**: LFSRs advance conditionally (not every step), creating
  non-linearity
- **Clock Control**: Mechanism determining when LFSRs advance (can be based on
  other LFSR outputs or external signals)
- **Non-Linear Combining**: Using non-linear functions to combine LFSR outputs
  (prevents linear analysis)
- **Filter Function**: Non-linear function applied to LFSR state to generate
  output (creates non-linear keystream)
- **Non-Linear Feedback**: Feedback function is not linear (generalizes LFSR to
  NFSR - Non-Linear Feedback Shift Register)

A5/1 Cipher
-----------

**Overview**:

A5/1 is a stream cipher that was used for GSM (Global System for Mobile
Communications) mobile phone encryption. It was designed in 1987 and became the
standard encryption algorithm for GSM voice and data communications.

**Historical Context**:

- **Designed**: 1987
- **Purpose**: GSM mobile phone encryption
- **Status**: Widely deployed, now considered insecure
- **Replacement**: A5/3 (KASUMI) and A5/4 (SNOW 3G) for 3G/4G

**Cipher Structure**:

A5/1 uses three LFSRs with irregular clocking:

- **LFSR1**: :math:`19` bits
  - Feedback polynomial: :math:`x^{19} + x^{18} + x^{17} + x^{14} + 1`
  - Taps at positions: :math:`18, 17, 16, 13`
- **LFSR2**: :math:`22` bits
  - Feedback polynomial: :math:`x^{22} + x^{21} + 1`
  - Taps at positions: :math:`21, 20`
- **LFSR3**: :math:`23` bits
  - Feedback polynomial: :math:`x^{23} + x^{22} + x^{21} + x^{8} + 1`
  - Taps at positions: :math:`22, 21, 20, 7`

**Clock Control**:

The clocking is controlled by a majority function:

- Clock control bits: :math:`\text{LFSR}_1[8]`,
  :math:`\text{LFSR}_2[10]`, :math:`\text{LFSR}_3[10]`
- Majority function: Outputs the majority value (:math:`0` or
  :math:`1`) of the three bits
- Clocking rule: An LFSR advances if its clock control bit matches the
  majority

**Output**:

The keystream is the XOR of the three LFSR output bits (most
significant bit, or MSB, of each LFSR).

**Key and IV**:

- **Key Size**: :math:`64` bits
- **IV Size**: :math:`22` bits (frame number in GSM)
- **Total State**: :math:`64` bits (:math:`19 + 22 + 23`)

**Initialization**:

1. Load :math:`64`-bit key into LFSRs (:math:`19 + 22 + 23` bits)
2. Load :math:`22`-bit frame number (IV) into LFSRs
3. Run :math:`100` warm-up steps (discard output)
4. Generate keystream

**Security Status**:

A5/1 has been extensively cryptanalyzed and is now considered insecure. Known
attacks include:

- **Time-Memory Trade-Off Attacks**: Barkan, Biham, Keller (2003) - can recover
  key in seconds with precomputed tables
- **Correlation Attacks**: Exploit correlations between keystream and LFSR sequences
- **Known-Plaintext Attacks**: Recover key from known plaintext-ciphertext pairs
- **Hardware-Based Attacks**: Side-channel and fault injection attacks

**Key Terminology**:

- **A5/1**: The stream cipher used in GSM encryption
- **GSM**: Global System for Mobile Communications, the standard for mobile phones
- **Irregular Clocking**: LFSRs don't always advance on each step
- **Majority Function**: Function that outputs the majority value of its inputs
- **Clock Control Bit**: Bit from each LFSR used to determine clocking
- **Frame Number**: The 22-bit IV used in GSM (represents frame number)
- **Warm-up Phase**: Initial :math:`100` steps before keystream generation (discarded)

**Mathematical Foundation**:

The majority function for three bits :math:`a, b, c` is:

.. math::

   \text{majority}(a, b, c) = (a \land b) \lor (a \land c) \lor (b \land c)

where :math:`\land` is AND and :math:`\lor` is OR.

The keystream output at step :math:`i` is:

.. math::

   K_i = L_1[i] \oplus L_2[i] \oplus L_3[i]

where :math:`L_j[i]` is the output bit (most significant bit, or MSB) of
:math:`\text{LFSR}_j` at step :math:`i`.

The clock control mechanism ensures that at each step, exactly two of the three
LFSRs advance (since majority of three bits always has at least two matching
values). This irregular clocking introduces non-linearity and prevents simple
linear analysis.

**Algorithm**:

1. **Initialization**:
   
   - Load key bits into LFSRs
   - Load frame number (IV) into LFSRs
   - Run :math:`100` warm-up steps

2. **Keystream Generation** (for each output bit :math:`i`):
   
   - Get clock control bits: :math:`c_1 = \text{LFSR}_1[8]`,
     :math:`c_2 = \text{LFSR}_2[10]`, :math:`c_3 = \text{LFSR}_3[10]`
   - Compute majority: :math:`m = \text{majority}(c_1, c_2, c_3)`
   - Clock LFSRs: Advance :math:`\text{LFSR}_j` if :math:`c_j = m`
   - Output: :math:`K_i = L_1[i] \oplus L_2[i] \oplus L_3[i]` (XOR of
     three LFSR output bits)

API Reference
-------------

The stream cipher analysis is implemented in the :mod:`lfsr.ciphers` module.
See :doc:`api/ciphers` for complete API documentation.

Command-Line Usage
------------------

Stream cipher analysis can be performed from the command line:

**Basic Usage**:

.. code-block:: bash

   lfsr-seq --cipher a5_1 --analyze-cipher

**Generate Keystream**:

.. code-block:: bash

   lfsr-seq --cipher a5_1 --generate-keystream --key-file key.bin --length 1000

**Apply Attacks**:

.. code-block:: bash

   lfsr-seq --cipher a5_1 --attack-cipher --keystream-file keystream.bin

**CLI Options**:
- ``--cipher NAME``: Select cipher (a5_1, a5_2, e0, trivium, grain, lili128)
- ``--analyze-cipher``: Analyze cipher structure
- ``--generate-keystream``: Generate keystream from key and IV
- ``--attack-cipher``: Apply attacks to keystream
- ``--compare-ciphers``: Compare multiple ciphers

Python API Usage
----------------

Here's a simple example demonstrating A5/1 analysis using the Python API:

.. code-block:: python

   from lfsr.ciphers.a5_1 import A5_1
   
   # Create A5/1 cipher instance
   cipher = A5_1()
   
   # Get cipher configuration
   config = cipher.get_config()
   print(f"Cipher: {config.cipher_name}")
   print(f"Key size: {config.key_size} bits")
   print(f"IV size: {config.iv_size} bits")
   
   # Analyze structure
   structure = cipher.analyze_structure()
   print(f"Number of LFSRs: {len(structure.lfsr_configs)}")
   print(f"Total state size: {structure.state_size} bits")
   
   # Generate keystream
   key = [1, 0, 1] * 21 + [1]  # 64-bit key
   iv = [0] * 22  # 22-bit IV (frame number)
   keystream = cipher.generate_keystream(key, iv, 100)
   print(f"Generated {len(keystream)} keystream bits")
   
   # Comprehensive analysis
   result = cipher.analyze(key=key, iv=iv, keystream_length=1000)
   print(f"Keystream balance: {result.keystream_properties['balance']:.4f}")
   
   # Analyze security properties
   if result.security_assessment:
       print(f"Security level: {result.security_assessment['level']}")
       print(f"Known vulnerabilities: {result.security_assessment['vulnerabilities']}")

Glossary
--------

**A5/1**
   Stream cipher used in GSM mobile phone encryption.

**Clock Control**
   Mechanism determining when LFSRs advance in irregular clocking.

**Clock Control Bit**
   Bit from each LFSR used to determine clocking behavior.

**Decryption**
   Process of converting ciphertext back to plaintext.

**Encryption**
   Process of converting plaintext to ciphertext using keystream.

**Frame Number**
   The :math:`22`-bit IV used in GSM (represents frame number).

**Initialization Vector (IV)**
   Non-secret value ensuring different keystreams for same key.

**Irregular Clocking**
   LFSRs don't always advance on each step (clock control).

**Keystream**
   Pseudorandom sequence of bits generated by the cipher.

**Key**
   Secret value used to initialize the cipher.

**Majority Function**
   Function that outputs the majority value of its inputs.

**State**
   Internal state of the cipher (LFSR states, memory elements, etc.).

**Stream Cipher**
   Symmetric encryption algorithm that encrypts data one bit at a time.

**Warm-up Phase**
   Initial steps where output is discarded (removes initialization artifacts).

**XOR (Exclusive OR)**
   Binary operation where :math:`0 \oplus 0 = 0`, :math:`0 \oplus 1 = 1`, :math:`1 \oplus 0 = 1`, :math:`1 \oplus 1 = 0`.

A5/2 Cipher
-----------

**Overview**:

A5/2 is a deliberately weakened variant of A5/1 designed for export restrictions.
It uses four LFSRs with more complex clocking than A5/1. A5/2 was never widely
deployed and is completely broken, serving as a cautionary example of the dangers
of deliberately weakened cryptography.

**Historical Context**:

- **Designed**: 1987 (weaker variant of A5/1)
- **Purpose**: GSM encryption for export-restricted countries
- **Status**: Completely broken, never widely deployed
- **Security**: Deliberately weakened for export compliance
- **Cryptanalysis**: Barkan, Biham, Keller (2003) - real-time key recovery

**Cipher Structure**:

A5/2 uses four LFSRs with irregular clocking:

- **LFSR1**: :math:`19` bits
- **LFSR2**: :math:`22` bits
- **LFSR3**: :math:`23` bits
- **LFSR4**: :math:`17` bits (additional LFSR for clock control)

**Clock Control**:

A5/2 uses a more complex clocking mechanism than A5/1, involving the fourth LFSR
in the clock control logic. However, this additional complexity did not improve
security due to deliberate weakening.

**Key and IV**:

- **Key Size**: :math:`64` bits (same as A5/1)
- **IV Size**: :math:`22` bits (frame number in GSM)
- **Total State**: :math:`81` bits (:math:`19 + 22 + 23 + 17`)

**Security Status**:

A5/2 is completely insecure:

- **Complete Break**: Barkan, Biham, Keller (2003) - real-time key recovery from
  ciphertext only
- **Deliberate Weakening**: Intentionally reduced security for export compliance
- **Never Deployed**: Replaced by stronger variants before widespread deployment
- **Lesson**: Demonstrates the security risks of deliberately weakened cryptography

**Key Terminology**:

- **A5/2**: Weaker variant of A5/1 for export restrictions
- **Export Restrictions**: Legal restrictions on exporting strong cryptography
  (historically, many countries restricted export of strong cryptographic systems)
- **Deliberate Weakening**: Intentionally reduced security for compliance with
  export regulations

E0 Cipher
---------

**Overview**:

E0 is a stream cipher used in Bluetooth encryption. It uses four LFSRs with a
finite state machine (FSM) combiner for non-linear combining. E0 was designed
for the Bluetooth specification and remains in use, though newer Bluetooth
versions use stronger encryption algorithms.

**Historical Context**:

- **Designed**: For Bluetooth specification (Bluetooth 1.0, 1999)
- **Purpose**: Bluetooth encryption for wireless communication
- **Status**: Still in use (though newer versions use stronger encryption)
- **Standard**: Bluetooth specification
- **Cryptanalysis**: Multiple attacks have been published, but E0 remains
  deployed in legacy Bluetooth devices

**Cipher Structure**:

E0 uses four LFSRs with FSM combiner:

- **LFSR1**: :math:`25` bits
- **LFSR2**: :math:`31` bits
- **LFSR3**: :math:`33` bits
- **LFSR4**: :math:`39` bits
- **FSM**: Finite state machine with :math:`4` states (:math:`2` bits of memory)

**Clock Control**:

All LFSRs clock every step (no irregular clocking). This is simpler than A5/1's
irregular clocking, but the FSM combiner provides non-linearity.

**Output**:

The keystream is generated by the FSM combiner, which provides non-linear
combining of the four LFSR outputs. The FSM state evolves based on the LFSR
outputs, creating a non-linear mixing function.

**Key and IV**:

- **Key Size**: :math:`128` bits
- **IV Size**: :math:`64` bits (:math:`8` bytes)
- **Total State**: :math:`128` bits (:math:`25 + 31 + 33 + 39`)

**Initialization**:

1. Load :math:`128`-bit key into LFSRs
2. Load :math:`64`-bit IV into LFSRs
3. Run warm-up phase (discard initial output)
4. Generate keystream

**Security Status**:

E0 has known weaknesses:

- **Correlation Attacks**: Exploit correlations between keystream and LFSR
  sequences
- **Algebraic Attacks**: Solve systems of equations to recover state
- **Time-Memory Trade-Off Attacks**: Precomputed tables for faster key recovery
- **However**: E0 remains in use in Bluetooth, demonstrating that known
  weaknesses do not always lead to immediate replacement in deployed systems

**Mathematical Foundation**:

The FSM combiner provides non-linear mixing. The FSM state :math:`s_t` at step
:math:`t` depends on the previous state :math:`s_{t-1}` and the LFSR outputs,
creating a non-linear function that is more complex than simple XOR.

**Key Terminology**:

- **E0**: Stream cipher used in Bluetooth encryption
- **Bluetooth**: Wireless communication standard for short-range communication
- **Finite State Machine (FSM)**: Memory element providing non-linear combining
  (the FSM has :math:`4` states, requiring :math:`2` bits of memory)
- **Non-Linear Combiner**: More complex than simple XOR, using FSM to mix LFSR
  outputs

Trivium Cipher
--------------

**Overview**:

Trivium is an eSTREAM finalist in the hardware category. It uses three shift
registers with non-linear feedback, optimized for hardware efficiency. Trivium
was designed to be simple, secure, and efficient in hardware implementations.

**Historical Context**:

- **Designed**: 2005 (Christophe De Cannière, Bart Preneel)
- **Purpose**: eSTREAM finalist (hardware category)
- **Status**: Considered secure, used in research and some applications
- **Design Goal**: Simple, efficient hardware implementation
- **eSTREAM Project**: European stream cipher project (2004-2008) that evaluated
  stream ciphers for different application categories

**Cipher Structure**:

Trivium uses three shift registers (not pure LFSRs, as they have non-linear
feedback):

- **Register A**: :math:`93` bits
- **Register B**: :math:`84` bits
- **Register C**: :math:`111` bits
- **Total State**: :math:`288` bits
- **Feedback**: Non-linear (AND operations create non-linearity)

**Key and IV**:

- **Key Size**: :math:`80` bits
- **IV Size**: :math:`80` bits
- **Total State**: :math:`288` bits

**Initialization**:

1. Load :math:`80`-bit key into registers
2. Load :math:`80`-bit IV into registers
3. Run :math:`4 \times 288 = 1152` warm-up steps (discard output, ensures
   proper mixing of key and IV)
4. Generate keystream

**Security Status**:

Trivium is considered secure:

- **No Practical Attacks**: No practical attacks found despite extensive
  analysis
- **Designed Security**: Designed for :math:`80`-bit security level
- **Extensively Analyzed**: Subject to extensive cryptanalysis as eSTREAM
  finalist
- **Research Use**: Used in research and some applications requiring hardware
  efficiency

**Mathematical Foundation**:

Trivium's non-linear feedback uses AND operations, creating non-linearity that
prevents linear analysis. The three registers interact through their feedback
functions, creating a complex non-linear system.

**Key Terminology**:

- **Trivium**: eSTREAM finalist stream cipher
- **eSTREAM**: European stream cipher project (2004-2008) that evaluated stream
  ciphers for software and hardware applications
- **Shift Register**: Generalization of LFSR (allows non-linear feedback, not
  just linear)
- **Non-Linear Feedback**: Feedback function is not linear (uses AND operations
  instead of XOR)
- **Hardware Efficiency**: Optimized for hardware implementation (simple
  operations, minimal gates)

Grain Family
------------

**Overview**:

The Grain family includes Grain-128 and Grain-128a, both eSTREAM finalists in
the hardware category. Grain uses one LFSR and one NFSR (Non-Linear Feedback
Shift Register) with a filter function, creating a hybrid design that combines
linear and non-linear components.

**Historical Context**:

- **Designed**: 2006 (Martin Hell, Thomas Johansson, Willi Meier)
- **Purpose**: eSTREAM finalist (hardware category)
- **Status**: Considered secure, used in research
- **Variants**: Grain-128, Grain-128a (authenticated encryption variant)
- **Design Philosophy**: Hybrid LFSR/NFSR design for hardware efficiency

**Cipher Structure**:

Grain uses a hybrid design:

- **LFSR**: :math:`128` bits (linear feedback shift register)
- **NFSR**: :math:`128` bits (non-linear feedback shift register)
- **Filter Function**: Non-linear function combining LFSR and NFSR outputs
- **Total State**: :math:`256` bits

**Key and IV**:

- **Key Size**: :math:`128` bits
- **IV Size**: :math:`96` bits
- **Total State**: :math:`256` bits

**Initialization**:

1. Load :math:`128`-bit key into LFSR and NFSR
2. Load :math:`96`-bit IV into LFSR and NFSR
3. Run warm-up phase (discard initial output)
4. Generate keystream

**Security Status**:

Grain is considered secure:

- **No Practical Attacks**: No practical attacks found despite extensive
  analysis
- **Designed Security**: Designed for :math:`128`-bit security level
- **Extensively Analyzed**: Subject to extensive cryptanalysis as eSTREAM
  finalist
- **Research Use**: Used in research and constrained environments

**Mathematical Foundation**:

The hybrid LFSR/NFSR design provides both linear and non-linear components. The
LFSR provides good statistical properties, while the NFSR provides non-linearity.
The filter function combines both outputs, creating a non-linear keystream.

**Key Terminology**:

- **Grain**: Family of eSTREAM finalist stream ciphers
- **NFSR**: Non-Linear Feedback Shift Register (generalization of LFSR with
  non-linear feedback)
- **Filter Function**: Non-linear function combining LFSR and NFSR outputs to
  generate keystream
- **Authenticated Encryption**: Grain-128a provides authentication in addition
  to encryption
- **Hybrid Design**: Combining linear (LFSR) and non-linear (NFSR) components

LILI-128 Cipher
---------------

**Overview**:

LILI-128 is an academic stream cipher design demonstrating clock-controlled LFSR
design. It uses two LFSRs where one controls the clocking of the other, creating
irregular clocking that introduces non-linearity. LILI-128 is primarily used for
research and education, demonstrating the clock-controlled LFSR design pattern.

**Historical Context**:

- **Designed**: Academic design (demonstrates clock-controlled LFSR pattern)
- **Purpose**: Demonstrates clock-controlled LFSR design pattern
- **Status**: Used primarily for research and education
- **Design Goal**: Educational demonstration of clock control mechanisms
- **Not for Production**: Not intended for production use, serves as educational
  example

**Cipher Structure**:

LILI-128 uses two LFSRs with clock control:

- **LFSRc**: :math:`39` bits (clock control LFSR)
- **LFSRd**: :math:`89` bits (data LFSR, clock-controlled)
- **Clock Control**: :math:`\text{LFSR}_c` output determines how many times
  :math:`\text{LFSR}_d` advances at each step

**Key and IV**:

- **Key Size**: :math:`128` bits
- **IV Size**: :math:`64` bits (typically)
- **Total State**: :math:`128` bits (:math:`39 + 89`)

**Initialization**:

1. Load :math:`128`-bit key into both LFSRs
2. Load :math:`64`-bit IV into both LFSRs
3. Run warm-up phase (discard initial output)
4. Generate keystream

**Security Status**:

LILI-128 has known vulnerabilities:

- **Correlation Attacks**: Exploit correlations between keystream and LFSR
  sequences
- **Clock Control Analysis**: Clock control mechanism can be analyzed and
  exploited
- **Educational Purpose**: Demonstrates design pattern but not intended for
  production use
- **Research Value**: Useful for understanding clock-controlled LFSR designs and
  their vulnerabilities

**Mathematical Foundation**:

The clock control mechanism means that :math:`\text{LFSR}_d` advances a variable
number of times at each step, determined by the output of :math:`\text{LFSR}_c`.
This irregular clocking introduces non-linearity, but the clock control function
itself can be analyzed and exploited.

**Key Terminology**:

- **LILI-128**: Academic stream cipher design demonstrating clock-controlled
  LFSR pattern
- **Clock-Controlled LFSR**: One LFSR controls when (or how many times) another
  LFSR advances
- **Irregular Clocking**: Clocking pattern is not regular (data LFSR advances
  variable number of times)
- **Clock Control Function**: Function determining clocking behavior (output of
  clock control LFSR determines data LFSR clocking)

Cipher Comparison
-----------------

The tool provides a comparison framework for analyzing multiple ciphers side-by-side.

**Comparison Features**:

- **Property Analysis**: Key size, IV size, state size, number of LFSRs
- **Security Assessment**: Known vulnerabilities and recommendations
- **Structure Comparison**: Clocking mechanisms, combining functions
- **Recommendations**: Guidance based on comparison

**Example Usage**:

.. code-block:: python

   from lfsr.ciphers import A5_1, E0, Trivium
   from lfsr.ciphers.comparison import compare_ciphers, generate_comparison_report
   
   comparison = compare_ciphers([A5_1(), E0(), Trivium()])
   report = generate_comparison_report(comparison)
   print(report)

Further Reading
---------------

**A5/1 and A5/2**:

- **Barkan, E., Biham, E., & Keller, N.** (2003). "Instant Ciphertext-Only
  Cryptanalysis of GSM Encrypted Communication". Advances in Cryptology - CRYPTO
  2003. This paper presents a complete break of A5/2 and improved attacks on A5/1.

- **Biryukov, A., Shamir, A., & Wagner, D.** (2000). "Real Time Cryptanalysis of
  A5/1 on a PC". Fast Software Encryption 2000. Demonstrates practical attacks on
  A5/1 using time-memory trade-offs.

- **Golic, J. D.** (1997). "Cryptanalysis of Alleged A5 Stream Cipher". Advances
  in Cryptology - EUROCRYPT 1997. Early cryptanalysis of A5/1.

**E0 (Bluetooth)**:

- **Lu, Y., Meier, W., & Vaudenay, S.** (2005). "The Conditional Correlation
  Attack: A Practical Attack on Bluetooth Encryption". Advances in Cryptology -
  CRYPTO 2005. Correlation attack on E0.

- **Courtois, N. T.** (2002). "Higher Order Correlation Attacks, XL Algorithm and
  Cryptanalysis of Toyocrypt". Information Security and Cryptology - ICISC 2002.
  Algebraic attacks applicable to E0.

**Trivium**:

- **De Cannière, C., & Preneel, B.** (2006). "Trivium: A Stream Cipher
  Construction Inspired by Block Cipher Design Principles". Selected Areas in
  Cryptography 2006. Original design paper for Trivium.

- **Raddum, H.** (2007). "Cryptanalytic Results on Trivium". eSTREAM Project
  Report. Cryptanalytic results on Trivium.

**Grain**:

- **Hell, M., Johansson, T., & Meier, W.** (2006). "Grain: A Stream Cipher for
  Constrained Environments". eSTREAM Project Report. Original design paper for
  Grain.

- **Berbain, C., Gilbert, H., & Maximov, A.** (2006). "Cryptanalysis of Grain".
  Fast Software Encryption 2006. Early cryptanalysis of Grain.

**General Stream Cipher Theory**:

- **Menezes, A. J., van Oorschot, P. C., & Vanstone, S. A.** (1996). "Handbook
  of Applied Cryptography". CRC Press. Chapter 6 covers stream ciphers and LFSRs.

- **Rueppel, R. A.** (1986). "Analysis and Design of Stream Ciphers". Springer.
  Comprehensive treatment of stream cipher design and analysis.

**Standards and Specifications**:

- **GSM Association.** "GSM Security Algorithms". Official specification for A5/1
  and A5/2.

- **Bluetooth SIG.** "Bluetooth Core Specification". Official specification
  including E0 cipher.

- **eSTREAM Project.** "The eSTREAM Portfolio". Final report on the eSTREAM
  project, including Trivium and Grain.
